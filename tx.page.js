/*!
Copyright (c) 2012-2013 AGITsol GmbH. Subject to the MIT licence. see tx.page.src.js for source.
*/
;jQuery(document).ready(function(f){var c=function(r,q,o,p,s){r.setParam("dataType","jsonp");r.setRequest(q);r.setIndicator(o);r.setMessageHandler(p);r.setCallback(s);r.execute()},e=function(){c(new Tx.Endpoint("StationSearch"),new Tx.RequestObject("StationSearch",{Site:Tx.config.site,onlyStartStations:true,orderBy:"name"}),new Tx.IndicatorSpinner(h),new Tx.MessageAlert(),function(o){d(i,o.itemList)})},k=function(){var o=parseInt(i.val(),10);c(new Tx.Endpoint("StationSearch"),new Tx.RequestObject("StationSearch",{Site:Tx.config.site,StationFrom:o,orderBy:"name"}),new Tx.IndicatorSpinner(a),new Tx.MessageAlert(),function(p){d(g,p.itemList)})},b=function(p){var o=Tx.toInt(i.val()),q=Tx.toInt(g.val());if(!o||!q){alert(Tx.out("[:en]Please select a start and a destination station.[:de]Bitte wählen Sie eine Start- und eine Zielhaltestelle."));Tx.stopEvent(p)}},d=function(o,p){o.empty();o.append(Tx.sprintf("<option value='%s'>%s</option>",0,Tx.out("[:en]– Please select –[:de]– Bitte wählen –")));f.each(p,function(q,r){o.append(Tx.sprintf("<option value='%s'>%s</option>",r.id,Tx.out(r.name)))})},n=f("#tixys-search").attr("action",Tx.config.urlBase).submit(b),l=n.find("input.tixys-select-day"),m=n.find("input[name=day]"),i=n.find("select.tixys-select-station-from").change(k),h=n.find("td.tixys-from img"),g=n.find("select.tixys-select-station-to"),a=n.find("img.tixys-to"),j=Tx.config.locale.substr(0,2)==="de";if(Tx.config.datepicker){l.datepicker({dateFormat:j?"dd.mm.yy":"yy-mm-dd",firstDay:j?1:0,altField:m,altFormat:"yy-mm-dd"}).datepicker("setDate",new Date())}e()});