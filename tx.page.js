/*!
Copyright (c) 2012-2013 AGITsol GmbH. Subject to the MIT licence. see tx.page.src.js for source.
*/
;jQuery(document).ready(function(d){var e=function(g,i,j){var h=new Tx.Endpoint("StationSearch");g.set("Site",Tx.config.site);g.set("orderBy","name");h.setParam("dataType","jsonp");h.setRequest(g);h.setIndicator(new Tx.IndicatorSpinner(i));h.setMessageHandler(new Tx.MessageAlert());h.setCallback(j);h.execute()},a=function(j,k,i,g){var h=Tx.toInt(k.val());if(!h){f(i,[])}else{if(!j.to){e(new Tx.RequestObject("StationSearch",{StationFrom:h}),g,function(l){f(i,l.itemList)})}}},b=function(k,i,j,h){var g=i.from||Tx.toInt(j.val()),l=i.to||Tx.toInt(h.val());if(!g||!l){alert(Tx.out("[:en]Please select a start and a destination station.[:de]Bitte wählen Sie eine Start- und eine Zielhaltestelle."));Tx.stopEvent(k)}},f=function(g,h){g.empty().attr("disabled",h.length?false:"disabled");if(h.length){g.append(Tx.sprintf("<option value='%s'>%s</option>",0,Tx.out("[:en]– Please select –[:de]– Bitte wählen –")));d.each(h,function(i,j){g.append(Tx.sprintf("<option value='%s'>%s</option>",j.id,Tx.out(j.name)))})}},c=Tx.config.locale.substr(0,2)==="de";d("form.tixys-search").each(function(){var k=d(this).attr("action",Tx.config.urlBase),m=txForms[k.attr("data-txform")],h=k.find("input.tixys-select-day"),l=k.find("input[name=day]"),n=k.find("select.tixys-select-station-from"),j=k.find("img.tixys-from"),i=k.find("select.tixys-select-station-to"),g=k.find("img.tixys-to");k.submit(function(o){b(o,m,n,i)});n.change(function(o){a(m,n,i,g)});if(m.datepicker){h.datepicker({dateFormat:c?"dd.mm.yy":"yy-mm-dd",firstDay:c?1:0,minDate:0,altField:l,altFormat:"yy-mm-dd"}).datepicker("setDate",new Date())}})});